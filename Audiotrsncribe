from pywinauto import Application
import time

# Connect to running Microsoft Teams app
app = Application(backend="uia").connect(title_re=".*Microsoft Teams.*")

def extract_captions():
    print("Extracting live captions from Teams window... Press Ctrl+C to stop.")

    while True:
        try:
            # Get the Teams window
            window = app.window(title_re=".*Microsoft Teams.*")

            # Extract visible text
            text = window.window(class_name="Chrome_WidgetWin_0").window_text()
            
            # Filter only caption-related text
            if text and len(text) > 5:  
                print("Live Caption:", text)
            
        except Exception as e:
            print("Error:", e)

        time.sleep(2)  # Refresh every 2 seconds

extract_captions()
